{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar ethereumjs_util_1 = require(\"ethereumjs-util\");\nvar _1 = require(\".\");\nvar TransactionFactory = /** @class */function () {\n  // It is not possible to instantiate a TransactionFactory object.\n  function TransactionFactory() {}\n  /**\n   * Create a transaction from a `txData` object\n   *\n   * @param txData - The transaction data. The `type` field will determine which transaction type is returned (if undefined, creates a legacy transaction)\n   * @param txOptions - Options to pass on to the constructor of the transaction\n   */\n  TransactionFactory.fromTxData = function (txData, txOptions) {\n    if (txOptions === void 0) {\n      txOptions = {};\n    }\n    if (!('type' in txData) || txData.type === undefined) {\n      // Assume legacy transaction\n      return _1.Transaction.fromTxData(txData, txOptions);\n    } else {\n      var txType = new ethereumjs_util_1.BN((0, ethereumjs_util_1.toBuffer)(txData.type)).toNumber();\n      if (txType === 0) {\n        return _1.Transaction.fromTxData(txData, txOptions);\n      } else if (txType === 1) {\n        return _1.AccessListEIP2930Transaction.fromTxData(txData, txOptions);\n      } else if (txType === 2) {\n        return _1.FeeMarketEIP1559Transaction.fromTxData(txData, txOptions);\n      } else {\n        throw new Error(\"Tx instantiation with type \".concat(txType, \" not supported\"));\n      }\n    }\n  };\n  /**\n   * This method tries to decode serialized data.\n   *\n   * @param data - The data Buffer\n   * @param txOptions - The transaction options\n   */\n  TransactionFactory.fromSerializedData = function (data, txOptions) {\n    if (txOptions === void 0) {\n      txOptions = {};\n    }\n    if (data[0] <= 0x7f) {\n      // Determine the type.\n      var EIP = void 0;\n      switch (data[0]) {\n        case 1:\n          EIP = 2930;\n          break;\n        case 2:\n          EIP = 1559;\n          break;\n        default:\n          throw new Error(\"TypedTransaction with ID \".concat(data[0], \" unknown\"));\n      }\n      if (EIP === 1559) {\n        return _1.FeeMarketEIP1559Transaction.fromSerializedTx(data, txOptions);\n      } else {\n        // EIP === 2930\n        return _1.AccessListEIP2930Transaction.fromSerializedTx(data, txOptions);\n      }\n    } else {\n      return _1.Transaction.fromSerializedTx(data, txOptions);\n    }\n  };\n  /**\n   * When decoding a BlockBody, in the transactions field, a field is either:\n   * A Buffer (a TypedTransaction - encoded as TransactionType || rlp(TransactionPayload))\n   * A Buffer[] (Legacy Transaction)\n   * This method returns the right transaction.\n   *\n   * @param data - A Buffer or Buffer[]\n   * @param txOptions - The transaction options\n   */\n  TransactionFactory.fromBlockBodyData = function (data, txOptions) {\n    if (txOptions === void 0) {\n      txOptions = {};\n    }\n    if (Buffer.isBuffer(data)) {\n      return this.fromSerializedData(data, txOptions);\n    } else if (Array.isArray(data)) {\n      // It is a legacy transaction\n      return _1.Transaction.fromValuesArray(data, txOptions);\n    } else {\n      throw new Error('Cannot decode transaction: unknown type input');\n    }\n  };\n  /**\n   * This helper method allows one to retrieve the class which matches the transactionID\n   * If transactionID is undefined, returns the legacy transaction class.\n   * @deprecated - This method is deprecated and will be removed on the next major release\n   * @param transactionID\n   * @param _common - This option is not used\n   */\n  TransactionFactory.getTransactionClass = function (transactionID, _common) {\n    if (transactionID === void 0) {\n      transactionID = 0;\n    }\n    var legacyTxn = transactionID == 0 || transactionID >= 0x80 && transactionID <= 0xff;\n    if (legacyTxn) {\n      return _1.Transaction;\n    }\n    switch (transactionID) {\n      case 1:\n        return _1.AccessListEIP2930Transaction;\n      case 2:\n        return _1.FeeMarketEIP1559Transaction;\n      default:\n        throw new Error(\"TypedTransaction with ID \".concat(transactionID, \" unknown\"));\n    }\n  };\n  return TransactionFactory;\n}();\nexports.default = TransactionFactory;","map":{"version":3,"mappings":"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","names":["ethereumjs_util_1","require","_1","TransactionFactory","fromTxData","txData","txOptions","type","undefined","Transaction","txType","BN","toBuffer","toNumber","AccessListEIP2930Transaction","FeeMarketEIP1559Transaction","Error","concat","fromSerializedData","data","EIP","fromSerializedTx","fromBlockBodyData","Buffer","isBuffer","Array","isArray","fromValuesArray","getTransactionClass","transactionID","_common","legacyTxn"],"ignoreList":[],"sourceRoot":"","sources":["../src/transactionFactory.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"script"}